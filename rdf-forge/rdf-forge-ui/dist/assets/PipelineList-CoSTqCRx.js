import{g as T,r as v,d as q,h as E,o as K,c as R,a as p,b as u,u as s,s as P,w as f,i as Q,j as G,t as $,F as H,k as J,e as B,l as j,m as z,n as W,f as D,p as X}from"./index-DFPn2aEF.js";import{s as Y,a as b}from"./column.esm-IejHIFmQ.js";import{s as Z,a as ee}from"./inputtext.esm-D_f3k6LS.js";import{s as M}from"./tag.esm-DtJLOoeh.js";import{g as I,p as A,a as te,d as le}from"./client-D1Swh3D-.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index.esm-BhZig3PL.js";import"./index.esm-mDTaD5AI.js";async function ie(l){return I("/pipelines",l)}async function ae(l){return I(`/pipelines/${l}`)}async function se(l){return A("/pipelines",l)}async function ue(l,o){return te(`/pipelines/${l}`,o)}async function oe(l){return le(`/pipelines/${l}`)}async function re(l){return A(`/pipelines/${l}/duplicate`)}async function pe(l,o){return A("/pipelines/validate",{definition:l,format:o})}async function ce(l,o){return A(`/pipelines/${l}/run`,{variables:o})}async function de(){return I("/operations")}const ve=T("pipeline",()=>{const l=v([]),o=v(null),y=v([]),c=v(!1),a=v(null);async function g(i){c.value=!0,a.value=null;try{return l.value=await ie(i),l.value}catch(n){return a.value=n.message,[]}finally{c.value=!1}}async function h(i){c.value=!0,a.value=null;try{return o.value=await ae(i),o.value}catch(n){return a.value=n.message,null}finally{c.value=!1}}async function _(i){c.value=!0,a.value=null;try{const n=await se(i);return l.value.unshift(n),n}catch(n){throw a.value=n.message,n}finally{c.value=!1}}async function C(i,n){var d;c.value=!0,a.value=null;try{const m=await ue(i,n),V=l.value.findIndex(N=>N.id===i);return V>=0&&(l.value[V]=m),((d=o.value)==null?void 0:d.id)===i&&(o.value=m),m}catch(m){throw a.value=m.message,m}finally{c.value=!1}}async function F(i){var n;c.value=!0,a.value=null;try{await oe(i),l.value=l.value.filter(d=>d.id!==i),((n=o.value)==null?void 0:n.id)===i&&(o.value=null)}catch(d){throw a.value=d.message,d}finally{c.value=!1}}async function L(i){c.value=!0,a.value=null;try{const n=await re(i);return l.value.unshift(n),n}catch(n){throw a.value=n.message,n}finally{c.value=!1}}async function O(i,n){try{return await pe(i,n)}catch(d){throw a.value=d.message,d}}async function x(i,n){try{return await ce(i,n)}catch(d){throw a.value=d.message,d}}async function S(){try{return y.value=await de(),y.value}catch(i){return a.value=i.message,[]}}function U(){o.value=null}return{pipelines:l,currentPipeline:o,operations:y,loading:c,error:a,fetchPipelines:g,fetchPipeline:h,createPipeline:_,updatePipeline:C,deletePipeline:F,duplicatePipeline:L,validatePipeline:O,runPipeline:x,fetchOperations:S,clearCurrentPipeline:U}}),fe={class:"pipeline-list"},ye={class:"header"},me={class:"actions"},he={class:"p-input-icon-left"},we={class:"empty-state"},Pe={class:"pipeline-name"},be={class:"name"},ge={class:"description"},_e={class:"step-count"},$e={key:0},Ce={key:1,class:"text-muted"},xe={class:"tags"},ke={class:"row-actions"},De={class:"confirmation-content"},Le=q({__name:"PipelineList",setup(l){const o=G(),y=ve(),c=v(!1),a=v(""),g=v(null),h=v(!1),_=v(null),C=v(!1),F=[{label:"All",value:null},{label:"Active",value:"active"},{label:"Draft",value:"draft"},{label:"Archived",value:"archived"}],L=v([]),O=E(()=>{let r=L.value;if(a.value){const t=a.value.toLowerCase();r=r.filter(w=>w.name.toLowerCase().includes(t)||w.description.toLowerCase().includes(t)||w.tags.some(e=>e.toLowerCase().includes(t)))}return g.value&&(r=r.filter(t=>t.status===g.value)),r});K(async()=>{await x()});async function x(){c.value=!0;try{L.value=await y.fetchPipelines()}finally{c.value=!1}}function S(){o.push("/pipelines/new")}function U(r){o.push(`/pipelines/${r.data.id}`)}async function i(r){await y.runPipeline(r.id),o.push("/jobs")}async function n(r){await y.duplicatePipeline(r.id),await x()}function d(r){_.value=r,h.value=!0}async function m(){if(_.value){C.value=!0;try{await y.deletePipeline(_.value.id),await x(),h.value=!1}finally{C.value=!1}}}function V(r){switch(r){case"active":return"success";case"draft":return"warning";case"archived":return"secondary";default:return"info"}}function N(r){return new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}return(r,t)=>{const w=W("tooltip");return D(),R("div",fe,[p("div",ye,[t[5]||(t[5]=p("h1",null,"Pipelines",-1)),p("div",me,[p("span",he,[t[4]||(t[4]=p("i",{class:"pi pi-search"},null,-1)),u(s(Z),{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),placeholder:"Search pipelines..."},null,8,["modelValue"])]),u(s(ee),{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),options:F,optionLabel:"label",optionValue:"value",placeholder:"Filter by status"},null,8,["modelValue"]),u(s(P),{label:"New Pipeline",icon:"pi pi-plus",onClick:S})])]),u(s(Y),{value:O.value,loading:c.value,paginator:!0,rows:10,rowsPerPageOptions:[10,25,50],dataKey:"id",globalFilterFields:["name","description","tags"],responsiveLayout:"scroll",class:"p-datatable-sm",onRowClick:U},{empty:f(()=>[p("div",we,[t[6]||(t[6]=p("i",{class:"pi pi-sitemap",style:{"font-size":"3rem",color:"var(--text-color-secondary)"}},null,-1)),t[7]||(t[7]=p("p",null,"No pipelines found",-1)),u(s(P),{label:"Create your first pipeline",icon:"pi pi-plus",onClick:S})])]),default:f(()=>[u(s(b),{field:"name",header:"Name",sortable:!0,style:{"min-width":"200px"}},{body:f(({data:e})=>[p("div",Pe,[p("span",be,$(e.name),1),p("span",ge,$(e.description),1)])]),_:1}),u(s(b),{field:"status",header:"Status",sortable:!0,style:{width:"120px"}},{body:f(({data:e})=>[u(s(M),{value:e.status,severity:V(e.status)},null,8,["value","severity"])]),_:1}),u(s(b),{field:"stepsCount",header:"Steps",sortable:!0,style:{width:"80px"}},{body:f(({data:e})=>[p("span",_e,$(e.stepsCount),1)]),_:1}),u(s(b),{field:"lastRun",header:"Last Run",sortable:!0,style:{width:"150px"}},{body:f(({data:e})=>[e.lastRun?(D(),R("span",$e,$(N(e.lastRun)),1)):(D(),R("span",Ce,"Never"))]),_:1}),u(s(b),{field:"tags",header:"Tags",style:{width:"200px"}},{body:f(({data:e})=>[p("div",xe,[(D(!0),R(H,null,J(e.tags,k=>(D(),X(s(M),{key:k,value:k,severity:"info",class:"mr-1"},null,8,["value"]))),128))])]),_:1}),u(s(b),{field:"updatedAt",header:"Updated",sortable:!0,style:{width:"150px"}},{body:f(({data:e})=>[B($(N(e.updatedAt)),1)]),_:1}),u(s(b),{style:{width:"120px"}},{body:f(({data:e})=>[p("div",ke,[j(u(s(P),{icon:"pi pi-play",class:"p-button-rounded p-button-success p-button-text",onClick:z(k=>i(e),["stop"])},null,8,["onClick"]),[[w,"Run"]]),j(u(s(P),{icon:"pi pi-copy",class:"p-button-rounded p-button-secondary p-button-text",onClick:z(k=>n(e),["stop"])},null,8,["onClick"]),[[w,"Duplicate"]]),j(u(s(P),{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-text",onClick:z(k=>d(e),["stop"])},null,8,["onClick"]),[[w,"Delete"]])])]),_:1})]),_:1},8,["value","loading"]),u(s(Q),{visible:h.value,"onUpdate:visible":t[3]||(t[3]=e=>h.value=e),header:"Confirm Delete",modal:!0,style:{width:"400px"}},{footer:f(()=>[u(s(P),{label:"Cancel",class:"p-button-text",onClick:t[2]||(t[2]=e=>h.value=!1)}),u(s(P),{label:"Delete",class:"p-button-danger",onClick:m,loading:C.value},null,8,["loading"])]),default:f(()=>{var e;return[p("div",De,[t[10]||(t[10]=p("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--yellow-500)"}},null,-1)),p("span",null,[t[8]||(t[8]=B("Are you sure you want to delete ",-1)),p("strong",null,$((e=_.value)==null?void 0:e.name),1),t[9]||(t[9]=B("?",-1))])])]}),_:1},8,["visible"])])}}}),Be=ne(Le,[["__scopeId","data-v-c56fcdb7"]]);export{Be as default};
