import{g as de,r as V,d as ce,h as J,a5 as pe,G as ve,o as me,c as g,a as l,b as n,u as s,s as x,p as fe,L as U,t as k,w as I,i as he,j as ye,F as K,k as j,C as Q,e as z,f as y}from"./index-DFPn2aEF.js";import{s as $,a as H}from"./inputtext.esm-D_f3k6LS.js";import{s as T}from"./index.esm-BhZig3PL.js";import{s as X}from"./textarea.esm-BYQDUK7K.js";import{s as ge}from"./chips.esm-_XqhYdn5.js";import{s as Y}from"./tag.esm-DtJLOoeh.js";import{s as ee}from"./panel.esm-BbERc45_.js";import{s as Ve,a as le}from"./tabpanel.esm-Ca3TB14W.js";import{g as W,p as L,a as we,d as be}from"./client-D1Swh3D-.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index.esm-mDTaD5AI.js";import"./index.esm-CdlE1liS.js";async function xe(u){return W("/shapes",u)}async function Ce(u){return W(`/shapes/${u}`)}async function _e(u){return L("/shapes",u)}async function Ue(u,v){return we(`/shapes/${u}`,v)}async function ke(u){return be(`/shapes/${u}`)}async function $e(u,v){return L("/shapes/validate-syntax",{content:u,format:v})}async function Ie(u,v,S){return L("/validation/run",{shapeId:u,data:v,dataFormat:S})}async function Te(u,v,S){return L("/validation/run",{shapeId:u,triplestoreId:v,graphUri:S})}async function Le(u,v,S){return L("/shapes/infer",{data:u,dataFormat:v,...S})}async function Ne(u){return L("/shapes/generate",u)}async function De(){return W("/templates/shapes")}const Pe=de("shacl",()=>{const u=V([]),v=V(null),S=V([]),w=V(null),p=V(!1),c=V(null);async function b(i){p.value=!0,c.value=null;try{return u.value=await xe(i),u.value}catch(r){return c.value=r.message,[]}finally{p.value=!1}}async function N(i){p.value=!0,c.value=null;try{return v.value=await Ce(i),v.value}catch(r){return c.value=r.message,null}finally{p.value=!1}}async function D(i){p.value=!0,c.value=null;try{const r=await _e(i);return u.value.unshift(r),r}catch(r){throw c.value=r.message,r}finally{p.value=!1}}async function P(i,r){var f;p.value=!0,c.value=null;try{const h=await Ue(i,r),E=u.value.findIndex(F=>F.id===i);return E>=0&&(u.value[E]=h),((f=v.value)==null?void 0:f.id)===i&&(v.value=h),h}catch(h){throw c.value=h.message,h}finally{p.value=!1}}async function R(i){var r;p.value=!0,c.value=null;try{await ke(i),u.value=u.value.filter(f=>f.id!==i),((r=v.value)==null?void 0:r.id)===i&&(v.value=null)}catch(f){throw c.value=f.message,f}finally{p.value=!1}}async function M(i,r){try{return await $e(i,r)}catch(f){throw c.value=f.message,f}}async function C(i,r,f){p.value=!0,c.value=null;try{return w.value=await Ie(i,r,f),w.value}catch(h){throw c.value=h.message,h}finally{p.value=!1}}async function t(i,r,f){p.value=!0,c.value=null;try{return w.value=await Te(i,r,f),w.value}catch(h){throw c.value=h.message,h}finally{p.value=!1}}async function m(i,r,f){p.value=!0,c.value=null;try{return await Le(i,r,f)}catch(h){throw c.value=h.message,h}finally{p.value=!1}}async function B(i){try{return await Ne(i)}catch(r){throw c.value=r.message,r}}async function O(){try{return S.value=await De(),S.value}catch(i){return c.value=i.message,[]}}function A(){v.value=null}function G(){w.value=null}return{shapes:u,currentShape:v,templates:S,lastValidationResult:w,loading:p,error:c,fetchShapes:b,fetchShape:N,createShape:D,updateShape:P,deleteShape:R,validateSyntax:M,runValidation:C,runValidationOnGraph:t,inferShape:m,generateTurtle:B,fetchTemplates:O,clearCurrentShape:A,clearValidationResult:G}}),Re={class:"shape-editor"},Me={class:"header"},Be={class:"header-left"},Ee={class:"title-section"},Fe={class:"header-actions"},Oe={class:"editor-content"},Ae={class:"editor-sidebar"},Ge={class:"field"},Ke={class:"field"},je={class:"field"},ze={class:"field"},He={class:"field"},Xe={class:"field"},We={class:"prefix-list"},Ze={class:"editor-main"},qe={class:"code-editor-container"},Je={class:"form-builder"},Qe={class:"properties-header"},Ye={key:0,class:"empty-properties"},el={class:"property-header"},ll={class:"property-path"},al={class:"property-actions"},tl={class:"property-form"},sl={class:"form-row"},nl={class:"field"},ol={class:"field"},ul={class:"form-row"},il={class:"field"},rl={class:"field"},dl={class:"form-row"},cl={class:"field"},pl={class:"field"},vl={key:0,class:"form-row"},ml={class:"field"},fl={class:"field"},hl={key:1,class:"field"},yl={key:2,class:"form-row"},gl={class:"field"},Vl={class:"field"},wl={class:"field"},bl={key:1,class:"generate-action"},Sl={class:"test-content"},xl={class:"field"},Cl={key:0,class:"test-results"},_l={key:0,class:"violations-list"},Ul={class:"violation-header"},kl={class:"focus-node"},$l={class:"violation-details"},Il={key:0},Tl={key:1},Ll=ce({__name:"ShapeEditor",setup(u){const v=pe(),S=ye(),w=Pe(),p=J(()=>v.params.id),c=J(()=>!p.value),b=V(null),N=V(0),D=V(!1),P=V(!1),R=V(!1),M=V(""),C=V(null),t=ve({uri:"",name:"",description:"",targetClass:"",category:"",tags:[],content:""}),m=V([]),B=V({sh:"http://www.w3.org/ns/shacl#",xsd:"http://www.w3.org/2001/XMLSchema#",schema:"http://schema.org/",ex:"http://example.org/"}),O=["Cube","Schema.org","DCAT","SKOS","Custom"],A=[{label:"String",value:"xsd:string"},{label:"Integer",value:"xsd:integer"},{label:"Decimal",value:"xsd:decimal"},{label:"Boolean",value:"xsd:boolean"},{label:"Date",value:"xsd:date"},{label:"DateTime",value:"xsd:dateTime"},{label:"IRI",value:null}],G=[{label:"Any",value:null},{label:"IRI",value:"sh:IRI"},{label:"Literal",value:"sh:Literal"},{label:"Blank Node",value:"sh:BlankNode"},{label:"IRI or Literal",value:"sh:IRIOrLiteral"}];me(async()=>{p.value?await i():t.content=r()});async function i(){b.value=await w.fetchShape(p.value),b.value&&(t.uri=b.value.uri,t.name=b.value.name,t.description=b.value.description||"",t.targetClass=b.value.targetClass||"",t.category=b.value.category||"",t.tags=b.value.tags||[],t.content=b.value.content)}function r(){return`@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix ex: <http://example.org/> .

ex:MyShape
  a sh:NodeShape ;
  sh:targetClass ex:MyClass ;
  sh:property [
    sh:path ex:name ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
  ] .
`}function f(){S.push("/shacl")}async function h(){try{const o=await w.validateSyntax(t.content,"turtle");o.valid?alert("Syntax is valid!"):alert(`Syntax errors:
`+o.errors.join(`
`))}catch(o){alert("Error: "+o.message)}}async function E(){D.value=!0;try{c.value?await w.createShape({uri:t.uri,name:t.name,description:t.description,targetClass:t.targetClass,category:t.category,tags:t.tags,content:t.content,contentFormat:"turtle"}):await w.updateShape(p.value,{uri:t.uri,name:t.name,description:t.description,targetClass:t.targetClass,category:t.category,tags:t.tags,content:t.content}),S.push("/shacl")}finally{D.value=!1}}function F(){m.value.push({path:"",minCount:0})}function ae(o){m.value.splice(o,1)}function te(o){o>0&&([m.value[o-1],m.value[o]]=[m.value[o],m.value[o-1]])}function se(o){o<m.value.length-1&&([m.value[o],m.value[o+1]]=[m.value[o+1],m.value[o]])}async function ne(){const o=await w.generateTurtle({uri:t.uri,targetClass:t.targetClass,properties:m.value});t.content=o,N.value=0}async function oe(){P.value=!0,C.value=null;try{C.value=await w.runValidation(p.value||"temp",M.value,"turtle")}finally{P.value=!1}}function ue(){const o=prompt("Enter prefix (e.g., foaf):"),e=prompt("Enter URI (e.g., http://xmlns.com/foaf/0.1/):");o&&e&&(B.value[o]=e)}function ie(o){return o.length>35?o.substring(0,35)+"...":o}function re(o){switch(o){case"Violation":return"danger";case"Warning":return"warning";case"Info":return"info";default:return"secondary"}}return(o,e)=>{var Z,q;return y(),g("div",Re,[l("div",Me,[l("div",Be,[n(s(x),{icon:"pi pi-arrow-left",class:"p-button-text",onClick:f}),l("div",Ee,[l("h1",null,k(c.value?"New Shape":(Z=b.value)==null?void 0:Z.name),1),c.value?U("",!0):(y(),fe(s(Y),{key:0,value:`v${(q=b.value)==null?void 0:q.version}`},null,8,["value"]))])]),l("div",Fe,[n(s(x),{label:"Validate Syntax",icon:"pi pi-check-circle",class:"p-button-outlined",onClick:h}),n(s(x),{label:"Test with Data",icon:"pi pi-play",class:"p-button-outlined",onClick:e[0]||(e[0]=a=>R.value=!0)}),n(s(x),{label:"Save",icon:"pi pi-save",onClick:E,loading:D.value},null,8,["loading"])])]),l("div",Oe,[l("div",Ae,[n(s(ee),{header:"Shape Info"},{default:I(()=>[l("div",Ge,[e[11]||(e[11]=l("label",{for:"shapeUri"},"Shape URI *",-1)),n(s($),{id:"shapeUri",modelValue:t.uri,"onUpdate:modelValue":e[1]||(e[1]=a=>t.uri=a),class:"w-full"},null,8,["modelValue"])]),l("div",Ke,[e[12]||(e[12]=l("label",{for:"shapeName"},"Name *",-1)),n(s($),{id:"shapeName",modelValue:t.name,"onUpdate:modelValue":e[2]||(e[2]=a=>t.name=a),class:"w-full"},null,8,["modelValue"])]),l("div",je,[e[13]||(e[13]=l("label",{for:"shapeDesc"},"Description",-1)),n(s(X),{id:"shapeDesc",modelValue:t.description,"onUpdate:modelValue":e[3]||(e[3]=a=>t.description=a),rows:2,class:"w-full"},null,8,["modelValue"])]),l("div",ze,[e[14]||(e[14]=l("label",{for:"targetClass"},"Target Class",-1)),n(s($),{id:"targetClass",modelValue:t.targetClass,"onUpdate:modelValue":e[4]||(e[4]=a=>t.targetClass=a),class:"w-full",placeholder:"e.g., schema:Person"},null,8,["modelValue"])]),l("div",He,[e[15]||(e[15]=l("label",{for:"category"},"Category",-1)),n(s(H),{id:"category",modelValue:t.category,"onUpdate:modelValue":e[5]||(e[5]=a=>t.category=a),options:O,placeholder:"Select category",class:"w-full"},null,8,["modelValue"])]),l("div",Xe,[e[16]||(e[16]=l("label",{for:"tags"},"Tags",-1)),n(s(ge),{id:"tags",modelValue:t.tags,"onUpdate:modelValue":e[6]||(e[6]=a=>t.tags=a),separator:",",class:"w-full"},null,8,["modelValue"])])]),_:1}),n(s(ee),{header:"Prefixes",toggleable:!0,collapsed:!0},{default:I(()=>[l("div",We,[(y(!0),g(K,null,j(B.value,(a,_)=>(y(),g("div",{key:_,class:"prefix-item"},[l("code",null,"@prefix "+k(_)+":",1),l("span",null,k(ie(a)),1)]))),128))]),n(s(x),{label:"Add Prefix",icon:"pi pi-plus",class:"p-button-text p-button-sm mt-2",onClick:ue})]),_:1})]),l("div",Ze,[n(s(Ve),{activeIndex:N.value,"onUpdate:activeIndex":e[8]||(e[8]=a=>N.value=a)},{default:I(()=>[n(s(le),{header:"Code Editor"},{default:I(()=>[l("div",qe,[n(s(X),{modelValue:t.content,"onUpdate:modelValue":e[7]||(e[7]=a=>t.content=a),class:"w-full code-textarea",rows:25,placeholder:"Enter SHACL shape in Turtle format..."},null,8,["modelValue"])])]),_:1}),n(s(le),{header:"Form Builder"},{default:I(()=>[l("div",Je,[l("div",Qe,[e[17]||(e[17]=l("h3",null,"Property Shapes",-1)),n(s(x),{label:"Add Property",icon:"pi pi-plus",class:"p-button-sm",onClick:F})]),m.value.length===0?(y(),g("div",Ye,[e[18]||(e[18]=l("i",{class:"pi pi-list",style:{"font-size":"2rem",color:"var(--text-color-secondary)"}},null,-1)),e[19]||(e[19]=l("p",null,"No property shapes defined",-1)),n(s(x),{label:"Add First Property",icon:"pi pi-plus",onClick:F})])):U("",!0),(y(!0),g(K,null,j(m.value,(a,_)=>(y(),g("div",{key:_,class:"property-card"},[l("div",el,[l("span",ll,k(a.path||"New Property"),1),l("div",al,[n(s(x),{icon:"pi pi-chevron-up",class:"p-button-rounded p-button-text p-button-sm",disabled:_===0,onClick:d=>te(_)},null,8,["disabled","onClick"]),n(s(x),{icon:"pi pi-chevron-down",class:"p-button-rounded p-button-text p-button-sm",disabled:_===m.value.length-1,onClick:d=>se(_)},null,8,["disabled","onClick"]),n(s(x),{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-text p-button-sm",onClick:d=>ae(_)},null,8,["onClick"])])]),l("div",tl,[l("div",sl,[l("div",nl,[e[20]||(e[20]=l("label",null,"Path *",-1)),n(s($),{modelValue:a.path,"onUpdate:modelValue":d=>a.path=d,placeholder:"e.g., schema:name",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),l("div",ol,[e[21]||(e[21]=l("label",null,"Name",-1)),n(s($),{modelValue:a.name,"onUpdate:modelValue":d=>a.name=d,placeholder:"Human-readable name",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])]),l("div",ul,[l("div",il,[e[22]||(e[22]=l("label",null,"Datatype",-1)),n(s(H),{modelValue:a.datatype,"onUpdate:modelValue":d=>a.datatype=d,options:A,optionLabel:"label",optionValue:"value",placeholder:"Select datatype",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),l("div",rl,[e[23]||(e[23]=l("label",null,"Node Kind",-1)),n(s(H),{modelValue:a.nodeKind,"onUpdate:modelValue":d=>a.nodeKind=d,options:G,optionLabel:"label",optionValue:"value",placeholder:"Select node kind",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])]),l("div",dl,[l("div",cl,[e[24]||(e[24]=l("label",null,"Min Count",-1)),n(s(T),{modelValue:a.minCount,"onUpdate:modelValue":d=>a.minCount=d,min:0,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),l("div",pl,[e[25]||(e[25]=l("label",null,"Max Count",-1)),n(s(T),{modelValue:a.maxCount,"onUpdate:modelValue":d=>a.maxCount=d,min:0,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])]),a.datatype==="xsd:string"?(y(),g("div",vl,[l("div",ml,[e[26]||(e[26]=l("label",null,"Min Length",-1)),n(s(T),{modelValue:a.minLength,"onUpdate:modelValue":d=>a.minLength=d,min:0,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),l("div",fl,[e[27]||(e[27]=l("label",null,"Max Length",-1)),n(s(T),{modelValue:a.maxLength,"onUpdate:modelValue":d=>a.maxLength=d,min:0,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])):U("",!0),a.datatype==="xsd:string"?(y(),g("div",hl,[e[28]||(e[28]=l("label",null,"Pattern (Regex)",-1)),n(s($),{modelValue:a.pattern,"onUpdate:modelValue":d=>a.pattern=d,placeholder:"^[A-Z].*$",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])):U("",!0),["xsd:integer","xsd:decimal"].includes(a.datatype||"")?(y(),g("div",yl,[l("div",gl,[e[29]||(e[29]=l("label",null,"Min Value",-1)),n(s(T),{modelValue:a.minInclusive,"onUpdate:modelValue":d=>a.minInclusive=d,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),l("div",Vl,[e[30]||(e[30]=l("label",null,"Max Value",-1)),n(s(T),{modelValue:a.maxInclusive,"onUpdate:modelValue":d=>a.maxInclusive=d,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])):U("",!0),l("div",wl,[e[31]||(e[31]=l("label",null,"Custom Message",-1)),n(s($),{modelValue:a.message,"onUpdate:modelValue":d=>a.message=d,placeholder:"Validation error message",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])]))),128)),m.value.length>0?(y(),g("div",bl,[n(s(x),{label:"Generate Turtle from Form",icon:"pi pi-code",onClick:ne})])):U("",!0)])]),_:1})]),_:1},8,["activeIndex"])])]),n(s(he),{visible:R.value,"onUpdate:visible":e[10]||(e[10]=a=>R.value=a),header:"Test Validation",style:{width:"800px"},modal:!0},{default:I(()=>[l("div",Sl,[l("div",xl,[e[32]||(e[32]=l("label",null,"Test Data (Turtle)",-1)),n(s(X),{modelValue:M.value,"onUpdate:modelValue":e[9]||(e[9]=a=>M.value=a),rows:10,class:"w-full code-textarea",placeholder:"@prefix schema: <http://schema.org/> ..."},null,8,["modelValue"])]),n(s(x),{label:"Run Validation",icon:"pi pi-play",onClick:oe,loading:P.value},null,8,["loading"]),C.value?(y(),g("div",Cl,[l("div",{class:Q(["result-header",C.value.conforms?"success":"error"])},[l("i",{class:Q(C.value.conforms?"pi pi-check-circle":"pi pi-times-circle")},null,2),l("span",null,k(C.value.conforms?"Validation Passed":`${C.value.violationCount} Violation(s)`),1)],2),C.value.conforms?U("",!0):(y(),g("div",_l,[(y(!0),g(K,null,j(C.value.violations,(a,_)=>(y(),g("div",{key:_,class:"violation-item"},[l("div",Ul,[n(s(Y),{value:a.severity,severity:re(a.severity)},null,8,["value","severity"]),l("span",kl,k(a.focusNode),1)]),l("div",$l,[a.path?(y(),g("span",Il,[e[33]||(e[33]=l("strong",null,"Path:",-1)),z(" "+k(a.path),1)])):U("",!0),a.value?(y(),g("span",Tl,[e[34]||(e[34]=l("strong",null,"Value:",-1)),z(" "+k(a.value),1)])):U("",!0),l("span",null,[e[35]||(e[35]=l("strong",null,"Message:",-1)),z(" "+k(a.message),1)])])]))),128))]))])):U("",!0)])]),_:1},8,["visible"])])}}}),jl=Se(Ll,[["__scopeId","data-v-5f64d11d"]]);export{jl as default};
