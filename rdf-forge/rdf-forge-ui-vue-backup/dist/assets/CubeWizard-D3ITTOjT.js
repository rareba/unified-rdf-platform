import{a2 as ve,a3 as fe,Y as I,a6 as Y,c as v,f as d,a as t,F as P,k as M,L as S,p as U,t as y,Z as be,d as he,r as h,h as O,b as o,u as n,w,e as _,s as F,l as ye,C as j,j as ge,n as we}from"./index-DFPn2aEF.js";import{s as Se}from"./fileupload.esm-CGwGkNkU.js";import{s as W,b as L,a as T}from"./column.esm-IejHIFmQ.js";import{s as D,a as N}from"./inputtext.esm-D_f3k6LS.js";import{s as Ve}from"./textarea.esm-BYQDUK7K.js";import{s as q}from"./calendar.esm-CEEyYCCC.js";import{s as ke}from"./chips.esm-_XqhYdn5.js";import{s as Ie,a as A}from"./tabpanel.esm-Ca3TB14W.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index.esm-mDTaD5AI.js";import"./progressbar.esm-Cw0SY2Ro.js";import"./index.esm-BhZig3PL.js";import"./index.esm-CdlE1liS.js";var Te={root:function(l){var a=l.props;return["p-steps p-component",{"p-readonly":a.readonly}]},menu:"p-steps-list",menuitem:function(l){var a=l.instance,f=l.item,V=l.index;return["p-steps-item",{"p-highlight p-steps-current":a.isActive(V),"p-disabled":a.isItemDisabled(f,V)}]},action:"p-menuitem-link",step:"p-steps-number",label:"p-steps-title"},xe=ve.extend({name:"steps",classes:Te}),De={name:"BaseSteps",extends:fe,props:{id:{type:String},model:{type:Array,default:null},readonly:{type:Boolean,default:!0},activeStep:{type:Number,default:0}},style:xe,provide:function(){return{$parentInstance:this}}},Z={name:"Steps",extends:De,inheritAttrs:!1,emits:["update:activeStep","step-change"],data:function(){return{d_activeStep:this.activeStep}},watch:{activeStep:function(l){this.d_activeStep=l}},mounted:function(){var l=this.findFirstItem();l&&(l.tabIndex="0")},methods:{getPTOptions:function(l,a,f){return this.ptm(l,{context:{item:a,index:f,active:this.isActive(f),disabled:this.isItemDisabled(a,f)}})},onItemClick:function(l,a,f){if(this.disabled(a)||this.readonly){l.preventDefault();return}a.command&&a.command({originalEvent:l,item:a}),f!==this.d_activeStep&&(this.d_activeStep=f,this.$emit("update:activeStep",this.d_activeStep)),this.$emit("step-change",{originalEvent:l,index:f})},onItemKeydown:function(l,a){switch(l.code){case"ArrowRight":{this.navigateToNextItem(l.target),l.preventDefault();break}case"ArrowLeft":{this.navigateToPrevItem(l.target),l.preventDefault();break}case"Home":{this.navigateToFirstItem(l.target),l.preventDefault();break}case"End":{this.navigateToLastItem(l.target),l.preventDefault();break}case"Tab":break;case"Enter":case"NumpadEnter":case"Space":{this.onItemClick(l,a),l.preventDefault();break}}},navigateToNextItem:function(l){var a=this.findNextItem(l);a&&this.setFocusToMenuitem(l,a)},navigateToPrevItem:function(l){var a=this.findPrevItem(l);a&&this.setFocusToMenuitem(l,a)},navigateToFirstItem:function(l){var a=this.findFirstItem(l);a&&this.setFocusToMenuitem(l,a)},navigateToLastItem:function(l){var a=this.findLastItem(l);a&&this.setFocusToMenuitem(l,a)},findNextItem:function(l){var a=l.parentElement.nextElementSibling;return a?a.children[0]:null},findPrevItem:function(l){var a=l.parentElement.previousElementSibling;return a?a.children[0]:null},findFirstItem:function(){var l=Y.findSingle(this.$refs.list,'[data-pc-section="menuitem"]');return l?l.children[0]:null},findLastItem:function(){var l=Y.find(this.$refs.list,'[data-pc-section="menuitem"]');return l?l[l.length-1].children[0]:null},setFocusToMenuitem:function(l,a){l.tabIndex="-1",a.tabIndex="0",a.focus()},isActive:function(l){return l===this.d_activeStep},isItemDisabled:function(l,a){return this.disabled(l)||this.readonly&&!this.isActive(a)},visible:function(l){return typeof l.visible=="function"?l.visible():l.visible!==!1},disabled:function(l){return typeof l.disabled=="function"?l.disabled():l.disabled},label:function(l){return typeof l.label=="function"?l.label():l.label},getMenuItemProps:function(l,a){var f=this;return{action:I({class:this.cx("action"),onClick:function(c){return f.onItemClick(c,l)},onKeyDown:function(c){return f.onItemKeydown(c,l)}},this.getPTOptions("action",l,a)),step:I({class:this.cx("step")},this.getPTOptions("step",l,a)),label:I({class:this.cx("label")},this.getPTOptions("label",l,a))}}}},Ue=["id"],Pe=["aria-current","onClick","onKeydown","data-p-highlight","data-p-disabled"];function _e(i,l,a,f,V,c){return d(),v("nav",I({id:i.id,class:i.cx("root")},i.ptmi("root")),[t("ol",I({ref:"list",class:i.cx("menu")},i.ptm("menu")),[(d(!0),v(P,null,M(i.model,function(p,b){return d(),v(P,{key:c.label(p)+"_"+b.toString()},[c.visible(p)?(d(),v("li",I({key:0,class:[i.cx("menuitem",{item:p,index:b}),p.class],style:p.style,"aria-current":c.isActive(b)?"step":void 0,onClick:function(C){return c.onItemClick(C,p,b)},onKeydown:function(C){return c.onItemKeydown(C,p,b)}},c.getPTOptions("menuitem",p,b),{"data-p-highlight":c.isActive(b),"data-p-disabled":c.isItemDisabled(p,b)}),[i.$slots.item?(d(),U(be(i.$slots.item),{key:1,item:p,index:b,active:b===V.d_activeStep,label:c.label(p),props:c.getMenuItemProps(p,b)},null,8,["item","index","active","label","props"])):(d(),v("span",I({key:0,class:i.cx("action")},c.getPTOptions("action",p,b)),[t("span",I({class:i.cx("step")},c.getPTOptions("step",p,b)),y(b+1),17),t("span",I({class:i.cx("label")},c.getPTOptions("label",p,b)),y(c.label(p)),17)],16))],16,Pe)):S("",!0)],64)}),128))],16)],16,Ue)}Z.render=_e;const Fe={class:"cube-wizard"},Le={class:"wizard-header"},Ne={class:"wizard-content"},Me={key:0,class:"step-content"},$e={key:0,class:"file-preview"},Re={class:"preview-info"},Ee={key:1,class:"step-content"},Oe={class:"column-info"},Ae={class:"column-name"},Be={class:"column-type"},ze={key:0,class:"dimension-mapping"},Ke={key:2,class:"step-content"},Xe={class:"metadata-form"},Ge={class:"field"},He={class:"field"},Ye={class:"field"},je={class:"field-row"},We={class:"field"},qe={class:"field"},Ze={class:"field"},Je={class:"field-row"},Qe={class:"field"},et={class:"field"},tt={class:"field"},lt={key:3,class:"step-content"},st={class:"observation-preview"},at={class:"shape-preview"},it={class:"validation-results"},nt={key:0,class:"validation-message"},ot={key:4,class:"step-content"},rt={class:"publish-options"},ut={class:"summary-card"},dt={class:"summary-item"},pt={class:"summary-item"},mt={class:"summary-item"},ct={class:"summary-item"},vt={class:"field"},ft={class:"triplestore-options"},bt=["onClick"],ht={class:"store-info"},yt={class:"store-name"},gt={class:"store-type"},wt={key:0,class:"pi pi-check"},St={class:"field"},Vt={class:"publish-checkboxes"},kt={class:"field-checkbox"},It={class:"field-checkbox"},Ct={class:"field-checkbox"},Tt={class:"wizard-footer"},xt=he({__name:"CubeWizard",setup(i){const l=ge(),a=h(0),f=h(null),V=h(!1),c=h([{label:"Upload"},{label:"Mapping"},{label:"Metadata"},{label:"Validate"},{label:"Publish"}]),p=h([]),b=h([]),x=h(0),C=h([]),J=[{label:"Dimension",value:"dimension"},{label:"Measure",value:"measure"},{label:"Attribute",value:"attribute"},{label:"Ignore",value:"ignore"}],Q=[{label:"String",value:"xsd:string"},{label:"Integer",value:"xsd:integer"},{label:"Decimal",value:"xsd:decimal"},{label:"Date",value:"xsd:date"},{label:"DateTime",value:"xsd:dateTime"},{label:"Boolean",value:"xsd:boolean"}],ee=h([{uri:"http://example.org/dimension/time",name:"Time Dimension"},{uri:"http://example.org/dimension/geo",name:"Geographic Dimension"}]),r=h({uri:"",title:"",description:"",publisher:"",contact:"",license:"",temporalStart:null,temporalEnd:null,keywords:[]}),te=[{label:"CC BY 4.0",value:"https://creativecommons.org/licenses/by/4.0/"},{label:"CC BY-SA 4.0",value:"https://creativecommons.org/licenses/by-sa/4.0/"},{label:"CC0 1.0",value:"https://creativecommons.org/publicdomain/zero/1.0/"},{label:"MIT License",value:"https://opensource.org/licenses/MIT"}],B=h(""),z=h(""),K=h([{name:"Cube Schema",valid:!0,message:""},{name:"SHACL Shape",valid:!0,message:""},{name:"Dimension Values",valid:!0,message:""}]),le=h([{id:"1",name:"Apache Fuseki (local)",type:"fuseki"},{id:"2",name:"Stardog Cloud",type:"stardog"},{id:"3",name:"GraphDB (production)",type:"graphdb"}]),$=h("1"),k=h({graphUri:"",savePipeline:!0,saveShape:!0,scheduleRefresh:!1}),X=O(()=>C.value.filter(u=>u.role==="dimension"&&u.include).length),G=O(()=>C.value.filter(u=>u.role==="measure"&&u.include).length),se=O(()=>{switch(a.value){case 0:return f.value!==null;case 1:return X.value>0&&G.value>0;case 2:return r.value.uri&&r.value.title;case 3:return K.value.every(u=>u.valid);default:return!0}});function ae(u){u.files.length>0&&(f.value=u.files[0],ne(u.files[0]))}function ie(u){u.files.length>0&&(f.value=u.files[0])}async function ne(u){const g=(await u.text()).split(`
`).filter(m=>m.trim()),s=g[0].split(",").map(m=>m.trim().replace(/"/g,""));b.value=s.map(m=>({field:m,header:m})),p.value=g.slice(1,6).map(m=>{const R=m.split(",").map(E=>E.trim().replace(/"/g,"")),H={};return s.forEach((E,ce)=>{H[E]=R[ce]||""}),H}),x.value=g.length-1,C.value=s.map(m=>({name:m,detectedType:oe(p.value.map(R=>R[m])),role:"dimension",datatype:"xsd:string",dimensionUri:null,include:!0})),r.value.uri=`http://example.org/cube/${u.name.replace(/\.[^.]+$/,"")}`,r.value.title=u.name.replace(/\.[^.]+$/,"").replace(/[-_]/g," "),k.value.graphUri=r.value.uri}function oe(u){const e=u.filter(g=>g).slice(0,10);return e.every(g=>!isNaN(Number(g))&&Number.isInteger(Number(g)))?"integer":e.every(g=>!isNaN(Number(g)))?"decimal":e.every(g=>/^\d{4}-\d{2}-\d{2}$/.test(g))?"date":"string"}function re(u){console.log("Create new dimension for",u.name)}function ue(){a.value>0&&a.value--}async function de(){a.value<4&&(a.value===2&&await pe(),a.value++)}async function pe(){B.value=`@prefix cube: <https://cube.link/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

<${r.value.uri}/observation/1>
  a cube:Observation ;
  cube:observedBy <${r.value.uri}> ;
  # ... sample observation data
  .`,z.value=`@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix cube: <https://cube.link/> .

<${r.value.uri}/shape>
  a sh:NodeShape ;
  sh:targetClass cube:Observation ;
  # ... generated constraints
  .`}async function me(){V.value=!0;try{await new Promise(u=>setTimeout(u,2e3)),l.push("/jobs")}finally{V.value=!1}}return(u,e)=>{const g=we("tooltip");return d(),v("div",Fe,[t("div",Le,[e[13]||(e[13]=t("h1",null,"Create RDF Cube",-1)),o(n(Z),{model:c.value,activeIndex:a.value},null,8,["model","activeIndex"])]),t("div",Ne,[a.value===0?(d(),v("div",Me,[e[16]||(e[16]=t("h2",null,"Upload Data Source",-1)),e[17]||(e[17]=t("p",{class:"step-description"},"Upload your tabular data file (CSV, XLSX, TSV) to begin creating an RDF cube.",-1)),o(n(Se),{mode:"advanced",multiple:!1,accept:".csv,.xlsx,.tsv",maxFileSize:1e8,onUpload:ie,onSelect:ae,auto:!1,chooseLabel:"Select File",uploadLabel:"Upload",cancelLabel:"Clear"},{empty:w(()=>[...e[14]||(e[14]=[t("div",{class:"upload-area"},[t("i",{class:"pi pi-cloud-upload",style:{"font-size":"3rem",color:"var(--primary-color)"}}),t("p",null,"Drag and drop your file here"),t("span",{class:"text-muted"},"Supported formats: CSV, XLSX, TSV (max 100MB)")],-1)])]),_:1}),f.value?(d(),v("div",$e,[e[15]||(e[15]=t("h3",null,"Preview",-1)),o(n(W),{value:p.value,rows:5,class:"p-datatable-sm"},{default:w(()=>[(d(!0),v(P,null,M(b.value,s=>(d(),U(n(T),{key:s.field,field:s.field,header:s.header},null,8,["field","header"]))),128))]),_:1},8,["value"]),t("p",Re,"Showing first "+y(p.value.length)+" of "+y(x.value)+" rows",1)])):S("",!0)])):S("",!0),a.value===1?(d(),v("div",Ee,[e[18]||(e[18]=t("h2",null,"Map Columns",-1)),e[19]||(e[19]=t("p",{class:"step-description"},"Specify the role of each column in your RDF cube.",-1)),o(n(W),{value:C.value,class:"mapping-table"},{default:w(()=>[o(n(T),{field:"name",header:"Column",style:{width:"200px"}},{body:w(({data:s})=>[t("div",Oe,[t("span",Ae,y(s.name),1),t("span",Be,y(s.detectedType),1)])]),_:1}),o(n(T),{field:"role",header:"Role",style:{width:"180px"}},{body:w(({data:s})=>[o(n(N),{modelValue:s.role,"onUpdate:modelValue":m=>s.role=m,options:J,optionLabel:"label",optionValue:"value",placeholder:"Select role",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(n(T),{field:"datatype",header:"Datatype",style:{width:"150px"}},{body:w(({data:s})=>[o(n(N),{modelValue:s.datatype,"onUpdate:modelValue":m=>s.datatype=m,options:Q,optionLabel:"label",optionValue:"value",placeholder:"Datatype",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(n(T),{field:"dimension",header:"Dimension Mapping",style:{"min-width":"200px"}},{body:w(({data:s})=>[s.role==="dimension"?(d(),v("div",ze,[o(n(N),{modelValue:s.dimensionUri,"onUpdate:modelValue":m=>s.dimensionUri=m,options:ee.value,optionLabel:"name",optionValue:"uri",placeholder:"Link to dimension",showClear:!0,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"]),ye(o(n(F),{icon:"pi pi-plus",class:"p-button-text",onClick:m=>re(s)},null,8,["onClick"]),[[g,"Create new dimension"]])])):S("",!0)]),_:1}),o(n(T),{field:"isDimension",header:"Include",style:{width:"80px"}},{body:w(({data:s})=>[o(n(L),{modelValue:s.include,"onUpdate:modelValue":m=>s.include=m,binary:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value"])])):S("",!0),a.value===2?(d(),v("div",Ke,[e[30]||(e[30]=t("h2",null,"Cube Metadata",-1)),e[31]||(e[31]=t("p",{class:"step-description"},"Provide metadata for your RDF cube.",-1)),t("div",Xe,[t("div",Ge,[e[20]||(e[20]=t("label",{for:"cubeUri"},"Cube URI *",-1)),o(n(D),{id:"cubeUri",modelValue:r.value.uri,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value.uri=s),class:"w-full"},null,8,["modelValue"]),e[21]||(e[21]=t("small",null,"Unique identifier for your cube",-1))]),t("div",He,[e[22]||(e[22]=t("label",{for:"cubeTitle"},"Title *",-1)),o(n(D),{id:"cubeTitle",modelValue:r.value.title,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.title=s),class:"w-full"},null,8,["modelValue"])]),t("div",Ye,[e[23]||(e[23]=t("label",{for:"cubeDescription"},"Description",-1)),o(n(Ve),{id:"cubeDescription",modelValue:r.value.description,"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.description=s),rows:3,class:"w-full"},null,8,["modelValue"])]),t("div",je,[t("div",We,[e[24]||(e[24]=t("label",{for:"publisher"},"Publisher",-1)),o(n(D),{id:"publisher",modelValue:r.value.publisher,"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.publisher=s),class:"w-full"},null,8,["modelValue"])]),t("div",qe,[e[25]||(e[25]=t("label",{for:"contact"},"Contact Email",-1)),o(n(D),{id:"contact",modelValue:r.value.contact,"onUpdate:modelValue":e[4]||(e[4]=s=>r.value.contact=s),type:"email",class:"w-full"},null,8,["modelValue"])])]),t("div",Ze,[e[26]||(e[26]=t("label",{for:"license"},"License",-1)),o(n(N),{id:"license",modelValue:r.value.license,"onUpdate:modelValue":e[5]||(e[5]=s=>r.value.license=s),options:te,optionLabel:"label",optionValue:"value",placeholder:"Select license",class:"w-full"},null,8,["modelValue"])]),t("div",Je,[t("div",Qe,[e[27]||(e[27]=t("label",{for:"temporalStart"},"Temporal Coverage Start",-1)),o(n(q),{id:"temporalStart",modelValue:r.value.temporalStart,"onUpdate:modelValue":e[6]||(e[6]=s=>r.value.temporalStart=s),dateFormat:"yy-mm-dd"},null,8,["modelValue"])]),t("div",et,[e[28]||(e[28]=t("label",{for:"temporalEnd"},"Temporal Coverage End",-1)),o(n(q),{id:"temporalEnd",modelValue:r.value.temporalEnd,"onUpdate:modelValue":e[7]||(e[7]=s=>r.value.temporalEnd=s),dateFormat:"yy-mm-dd"},null,8,["modelValue"])])]),t("div",tt,[e[29]||(e[29]=t("label",{for:"keywords"},"Keywords",-1)),o(n(ke),{id:"keywords",modelValue:r.value.keywords,"onUpdate:modelValue":e[8]||(e[8]=s=>r.value.keywords=s),separator:","},null,8,["modelValue"])])])])):S("",!0),a.value===3?(d(),v("div",lt,[e[32]||(e[32]=t("h2",null,"Preview & Validate",-1)),e[33]||(e[33]=t("p",{class:"step-description"},"Review the generated RDF observations and validate the cube.",-1)),o(n(Ie),null,{default:w(()=>[o(n(A),{header:"Sample Observations"},{default:w(()=>[t("div",st,[t("pre",null,y(B.value),1)])]),_:1}),o(n(A),{header:"Generated Shape"},{default:w(()=>[t("div",at,[t("pre",null,y(z.value),1)])]),_:1}),o(n(A),{header:"Validation"},{default:w(()=>[t("div",it,[(d(!0),v(P,null,M(K.value,s=>(d(),v("div",{key:s.name,class:"validation-item"},[t("i",{class:j(s.valid?"pi pi-check-circle text-green-500":"pi pi-times-circle text-red-500")},null,2),t("span",null,y(s.name),1),s.message?(d(),v("span",nt,y(s.message),1)):S("",!0)]))),128))])]),_:1})]),_:1})])):S("",!0),a.value===4?(d(),v("div",ot,[e[45]||(e[45]=t("h2",null,"Publish Cube",-1)),e[46]||(e[46]=t("p",{class:"step-description"},"Choose where to publish your RDF cube.",-1)),t("div",rt,[t("div",ut,[e[38]||(e[38]=t("h3",null,"Summary",-1)),t("div",dt,[e[34]||(e[34]=t("span",null,"Cube:",-1)),_(" "+y(r.value.title),1)]),t("div",pt,[e[35]||(e[35]=t("span",null,"Observations:",-1)),_(" "+y(x.value),1)]),t("div",mt,[e[36]||(e[36]=t("span",null,"Dimensions:",-1)),_(" "+y(X.value),1)]),t("div",ct,[e[37]||(e[37]=t("span",null,"Measures:",-1)),_(" "+y(G.value),1)])]),t("div",vt,[e[40]||(e[40]=t("label",null,"Destination Triplestore",-1)),t("div",ft,[(d(!0),v(P,null,M(le.value,s=>(d(),v("div",{key:s.id,class:j(["triplestore-option",{selected:$.value===s.id}]),onClick:m=>$.value=s.id},[e[39]||(e[39]=t("i",{class:"pi pi-database"},null,-1)),t("div",ht,[t("span",yt,y(s.name),1),t("span",gt,y(s.type),1)]),$.value===s.id?(d(),v("i",wt)):S("",!0)],10,bt))),128))])]),t("div",St,[e[41]||(e[41]=t("label",{for:"graphUri"},"Graph URI",-1)),o(n(D),{id:"graphUri",modelValue:k.value.graphUri,"onUpdate:modelValue":e[9]||(e[9]=s=>k.value.graphUri=s),class:"w-full"},null,8,["modelValue"])]),t("div",Vt,[t("div",kt,[o(n(L),{id:"savePipeline",modelValue:k.value.savePipeline,"onUpdate:modelValue":e[10]||(e[10]=s=>k.value.savePipeline=s),binary:!0},null,8,["modelValue"]),e[42]||(e[42]=t("label",{for:"savePipeline"},"Save pipeline for future updates",-1))]),t("div",It,[o(n(L),{id:"saveShape",modelValue:k.value.saveShape,"onUpdate:modelValue":e[11]||(e[11]=s=>k.value.saveShape=s),binary:!0},null,8,["modelValue"]),e[43]||(e[43]=t("label",{for:"saveShape"},"Save SHACL shape to library",-1))]),t("div",Ct,[o(n(L),{id:"scheduleRefresh",modelValue:k.value.scheduleRefresh,"onUpdate:modelValue":e[12]||(e[12]=s=>k.value.scheduleRefresh=s),binary:!0},null,8,["modelValue"]),e[44]||(e[44]=t("label",{for:"scheduleRefresh"},"Schedule periodic refresh",-1))])])])])):S("",!0)]),t("div",Tt,[a.value>0?(d(),U(n(F),{key:0,label:"Back",icon:"pi pi-arrow-left",class:"p-button-text",onClick:ue})):S("",!0),e[47]||(e[47]=t("div",{class:"spacer"},null,-1)),a.value<4?(d(),U(n(F),{key:1,label:"Next",icon:"pi pi-arrow-right",iconPos:"right",onClick:de,disabled:!se.value},null,8,["disabled"])):(d(),U(n(F),{key:2,label:"Publish",icon:"pi pi-cloud-upload",onClick:me,loading:V.value},null,8,["loading"]))])])}}}),Bt=Ce(xt,[["__scopeId","data-v-80626c98"]]);export{Bt as default};
