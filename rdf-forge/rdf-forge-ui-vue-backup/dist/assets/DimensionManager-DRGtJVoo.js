import{g as re,d as ue,aj as de,r as V,o as ce,c as E,a as p,b as s,U as l,w as o,e as v,p as D,u as f,L as me,F as pe,k as ve,t as w,m as fe,f as _}from"./index-DFPn2aEF.js";import{b as r}from"./client-D1Swh3D-.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const y={list(e){return r.get("/dimensions",{params:e})},get(e){return r.get(`/dimensions/${e}`)},create(e){return r.post("/dimensions",e)},update(e,t){return r.put(`/dimensions/${e}`,t)},delete(e){return r.delete(`/dimensions/${e}`)},getValues(e,t){return r.get(`/dimensions/${e}/values`,{params:t})},addValue(e,t){return r.post(`/dimensions/${e}/values`,t)},updateValue(e,t){return r.put(`/dimensions/values/${e}`,t)},deleteValue(e){return r.delete(`/dimensions/values/${e}`)},importCsv(e,t){const i=new FormData;return i.append("file",t),r.post(`/dimensions/${e}/import/csv`,i,{headers:{"Content-Type":"multipart/form-data"}})},exportTurtle(e){return r.get(`/dimensions/${e}/export/turtle`,{responseType:"blob"})},getTree(e){return r.get(`/dimensions/${e}/tree`)},getStats(e){return r.get("/dimensions/stats",{params:{projectId:e}})},listHierarchies(e){return r.get("/hierarchies",{params:{dimensionId:e}})},createHierarchy(e){return r.post("/hierarchies",e)},exportSkos(e,t){return r.get(`/hierarchies/${e}/export/skos`,{params:{dimensionId:t},responseType:"blob"})}},ge=re("dimension",{state:()=>({dimensions:[],currentDimension:null,currentValues:[],totalDimensions:0,loading:!1,error:null}),actions:{async fetchDimensions(e){this.loading=!0;try{const t=await y.list(e);this.dimensions=t.data.content,this.totalDimensions=t.data.totalElements}catch(t){this.error=t.message}finally{this.loading=!1}},async fetchDimension(e){this.loading=!0;try{const t=await y.get(e);this.currentDimension=t.data}catch(t){this.error=t.message}finally{this.loading=!1}},async createDimension(e){try{const t=await y.create(e);return this.dimensions.push(t.data),t.data}catch(t){throw this.error=t.message,t}},async deleteDimension(e){var t;try{await y.delete(e),this.dimensions=this.dimensions.filter(i=>i.id!==e),((t=this.currentDimension)==null?void 0:t.id)===e&&(this.currentDimension=null)}catch(i){throw this.error=i.message,i}},async fetchValues(e,t){try{const i=await y.getValues(e,t);return this.currentValues=i.data.content,i.data}catch(i){throw this.error=i.message,i}},async importValues(e,t){try{await y.importCsv(e,t),await this.fetchValues(e)}catch(i){throw this.error=i.message,i}}}}),ye={class:"dimension-manager"},he={class:"d-flex align-center mb-4"},be={key:1,class:"d-flex justify-center pa-4"},Ve={class:"text-subtitle-1 mb-2"},De={class:"text-body-2 mb-4"},xe={class:"d-flex justify-space-between align-center mb-2"},we={class:"text-caption"},ke={class:"text-center text-grey"},Ce=ue({__name:"DimensionManager",setup(e){const t=ge(),{dimensions:i,currentDimension:d,currentValues:B,loading:K}=de(t),k=V(""),h=V(!1),b=V(!1),T=V(null),c=V({name:"",uri:"",type:"KEY",description:""}),O=["TEMPORAL","GEO","KEY","MEASURE","ATTRIBUTE","CODED"],Y=[{title:"Code",key:"code",align:"start"},{title:"Label",key:"label",align:"start"},{title:"URI",key:"uri",align:"start"},{title:"Level",key:"hierarchyLevel",align:"end"}];ce(()=>{t.fetchDimensions()});function j(u){return{TEMPORAL:"blue",GEO:"green",KEY:"purple",MEASURE:"orange",ATTRIBUTE:"grey"}[u]||"grey"}function F(){t.fetchDimensions({search:k.value})}async function U(u){await t.fetchDimension(u),$()}async function $(){var u;(u=d.value)!=null&&u.id&&(b.value=!0,await t.fetchValues(d.value.id),b.value=!1)}function H(){c.value={name:"",uri:"",type:"KEY",description:""},h.value=!0}async function S(){await t.createDimension(c.value),h.value=!1,i.value.length>0&&U(i.value[i.value.length-1].id)}async function q(){var u;!((u=d.value)!=null&&u.id)||!confirm("Are you sure?")||await t.deleteDimension(d.value.id)}function z(){var u;(u=T.value)==null||u.click()}async function G(u){var g,m;const n=(g=u.target.files)==null?void 0:g[0];if(!(!n||!((m=d.value)!=null&&m.id))){b.value=!0;try{await t.importValues(d.value.id,n)}finally{b.value=!1}}}function P(){alert("Exporting Turtle...")}return(u,n)=>{const g=l("v-spacer"),m=l("v-btn"),I=l("v-card-title"),C=l("v-text-field"),R=l("v-icon"),A=l("v-list-item"),J=l("v-list-item-title"),Q=l("v-list"),W=l("v-progress-circular"),x=l("v-card"),L=l("v-col"),X=l("v-toolbar-title"),Z=l("v-toolbar"),ee=l("v-divider"),te=l("v-data-table"),M=l("v-card-text"),ne=l("v-row"),se=l("v-select"),oe=l("v-textarea"),ie=l("v-form"),ae=l("v-card-actions"),le=l("v-dialog");return _(),E("div",ye,[p("div",he,[n[8]||(n[8]=p("h1",{class:"text-h4"},"Dimensions",-1)),s(g),s(m,{color:"primary","prepend-icon":"mdi-plus",onClick:H},{default:o(()=>[...n[7]||(n[7]=[v(" New Dimension ",-1)])]),_:1})]),s(ne,null,{default:o(()=>[s(L,{cols:"12",md:"4"},{default:o(()=>[s(x,{class:"mb-4"},{default:o(()=>[s(I,null,{default:o(()=>[...n[9]||(n[9]=[v("Dimension List",-1)])]),_:1}),s(C,{modelValue:k.value,"onUpdate:modelValue":n[0]||(n[0]=a=>k.value=a),"prepend-inner-icon":"mdi-magnify",label:"Search dimensions...","single-line":"","hide-details":"",class:"mx-4 mb-2",onInput:F},null,8,["modelValue"]),f(K)?(_(),E("div",be,[s(W,{indeterminate:""})])):(_(),D(Q,{key:0,lines:"two"},{default:o(()=>[(_(!0),E(pe,null,ve(f(i),a=>{var N;return _(),D(A,{key:a.id,title:a.name,subtitle:a.type+" â€¢ "+(a.valueCount||0)+" values",active:((N=f(d))==null?void 0:N.id)===a.id,onClick:Ee=>U(a.id)},{prepend:o(()=>[s(R,{color:j(a.type||"KEY")},{default:o(()=>[...n[10]||(n[10]=[v("mdi-shape",-1)])]),_:1},8,["color"])]),_:2},1032,["title","subtitle","active","onClick"])}),128)),f(i).length===0?(_(),D(A,{key:0},{default:o(()=>[s(J,{class:"text-grey"},{default:o(()=>[...n[11]||(n[11]=[v("No dimensions found",-1)])]),_:1})]),_:1})):me("",!0)]),_:1}))]),_:1})]),_:1}),s(L,{cols:"12",md:"8"},{default:o(()=>[f(d)?(_(),D(x,{key:0},{default:o(()=>[s(Z,{color:"surface",flat:"",class:"border-b"},{default:o(()=>[s(X,null,{default:o(()=>[v(w(f(d).name),1)]),_:1}),s(g),s(m,{icon:"mdi-download",title:"Export Turtle",onClick:P}),s(m,{icon:"mdi-upload",title:"Import CSV",onClick:z}),s(m,{icon:"mdi-delete",color:"error",onClick:q}),p("input",{type:"file",ref_key:"fileInput",ref:T,style:{display:"none"},accept:".csv",onChange:G},null,544)]),_:1}),s(M,{class:"pa-4"},{default:o(()=>[p("div",Ve,"URI: "+w(f(d).uri),1),p("div",De,w(f(d).description),1),s(ee,{class:"mb-4"}),p("div",xe,[n[13]||(n[13]=p("h3",{class:"text-h6"},"Values",-1)),s(m,{size:"small",variant:"text","prepend-icon":"mdi-refresh",onClick:$},{default:o(()=>[...n[12]||(n[12]=[v("Refresh",-1)])]),_:1})]),s(te,{headers:Y,items:f(B),loading:b.value},{"item.uri":o(({item:a})=>[p("span",we,w(a.uri),1)]),_:1},8,["items","loading"])]),_:1})]),_:1})):(_(),D(x,{key:1,class:"d-flex align-center justify-center fill-height","min-height":"400"},{default:o(()=>[p("div",ke,[s(R,{size:"64",class:"mb-2"},{default:o(()=>[...n[14]||(n[14]=[v("mdi-arrow-left",-1)])]),_:1}),n[15]||(n[15]=p("div",{class:"text-h6"},"Select a dimension to view details",-1))])]),_:1}))]),_:1})]),_:1}),s(le,{modelValue:h.value,"onUpdate:modelValue":n[6]||(n[6]=a=>h.value=a),"max-width":"500"},{default:o(()=>[s(x,null,{default:o(()=>[s(I,null,{default:o(()=>[...n[16]||(n[16]=[v("Create New Dimension",-1)])]),_:1}),s(M,null,{default:o(()=>[s(ie,{onSubmit:fe(S,["prevent"])},{default:o(()=>[s(C,{modelValue:c.value.name,"onUpdate:modelValue":n[1]||(n[1]=a=>c.value.name=a),label:"Name",required:""},null,8,["modelValue"]),s(C,{modelValue:c.value.uri,"onUpdate:modelValue":n[2]||(n[2]=a=>c.value.uri=a),label:"URI",required:""},null,8,["modelValue"]),s(se,{modelValue:c.value.type,"onUpdate:modelValue":n[3]||(n[3]=a=>c.value.type=a),items:O,label:"Type"},null,8,["modelValue"]),s(oe,{modelValue:c.value.description,"onUpdate:modelValue":n[4]||(n[4]=a=>c.value.description=a),label:"Description"},null,8,["modelValue"])]),_:1})]),_:1}),s(ae,null,{default:o(()=>[s(g),s(m,{variant:"text",onClick:n[5]||(n[5]=a=>h.value=!1)},{default:o(()=>[...n[17]||(n[17]=[v("Cancel",-1)])]),_:1}),s(m,{color:"primary",onClick:S},{default:o(()=>[...n[18]||(n[18]=[v("Create",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Se=_e(Ce,[["__scopeId","data-v-c76b1145"]]);export{Se as default};
