import{d as Q,r as v,h as m,o as H,y as W,c as u,a as n,b as i,u as o,s as g,t as l,w as d,j as X,p as $,e as A,l as _,L as N,m as w,n as Y,f as a}from"./index-DFPn2aEF.js";import{s as Z,a as c}from"./column.esm-IejHIFmQ.js";import{s as ee,a as te}from"./inputtext.esm-D_f3k6LS.js";import{s as se}from"./calendar.esm-CEEyYCCC.js";import{s as T}from"./tag.esm-DtJLOoeh.js";import{s as ne}from"./progressbar.esm-Cw0SY2Ro.js";import{u as oe}from"./job-363zI-rv.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index.esm-BhZig3PL.js";import"./index.esm-mDTaD5AI.js";import"./index.esm-CdlE1liS.js";import"./client-D1Swh3D-.js";const ae={class:"job-list"},le={class:"header"},re={class:"actions"},ue={class:"p-input-icon-left"},de={class:"stats-bar"},ce={class:"stat-item"},pe={class:"stat-value"},fe={class:"stat-item"},ve={class:"stat-value"},me={class:"stat-item"},ge={class:"stat-value"},ye={class:"stat-item"},be={class:"stat-value"},he={class:"job-id"},_e={class:"pipeline-info"},we={class:"pipeline-name"},ke={class:"pipeline-version"},xe={key:1,class:"text-green-500"},De={key:2,class:"text-red-500"},Ce={key:3,class:"text-muted"},$e={key:0,class:"metrics"},Se={key:1,class:"text-muted"},Ve={key:0},Je={key:1,class:"text-muted"},Le={key:0},Ae={key:1,class:"running-timer"},Ne={key:2,class:"text-muted"},Te={class:"row-actions"},Me=Q({__name:"JobList",setup(Re){const S=X(),k=oe(),y=v(!1),b=v(""),h=v(null),V=v(null),p=v([]);let x;const M=[{label:"All",value:null},{label:"Running",value:"running"},{label:"Completed",value:"completed"},{label:"Failed",value:"failed"},{label:"Pending",value:"pending"},{label:"Cancelled",value:"cancelled"}],R=m(()=>{let e=p.value;if(b.value){const s=b.value.toLowerCase();e=e.filter(r=>r.id.toLowerCase().includes(s)||r.pipelineName.toLowerCase().includes(s))}return h.value&&(e=e.filter(s=>s.status===h.value)),e}),B=m(()=>p.value.filter(e=>e.status==="running").length),I=m(()=>{const e=new Date().toDateString();return p.value.filter(s=>s.status==="completed"&&s.completedAt&&new Date(s.completedAt).toDateString()===e).length}),P=m(()=>{const e=new Date().toDateString();return p.value.filter(s=>s.status==="failed"&&s.completedAt&&new Date(s.completedAt).toDateString()===e).length}),F=m(()=>{const e=p.value.filter(r=>r.duration);if(e.length===0)return"-";const s=e.reduce((r,t)=>r+(t.duration||0),0)/e.length;return D(s)});H(async()=>{await f(),x=window.setInterval(f,5e3)}),W(()=>{x&&clearInterval(x)});async function f(){y.value=!0;try{p.value=await k.fetchJobs()}finally{y.value=!1}}function J(e){S.push(`/jobs/${e.data.id}`)}async function U(e){await k.cancelJob(e.id),await f()}async function j(e){await k.retryJob(e.id),await f()}function q(e){S.push(`/jobs/${e.id}/logs`)}function K(e){switch(e){case"running":return"info";case"completed":return"success";case"failed":return"danger";case"cancelled":return"warning";default:return"secondary"}}function O(e){switch(e){case"running":return"pi pi-spin pi-spinner";case"completed":return"pi pi-check";case"failed":return"pi pi-times";case"cancelled":return"pi pi-ban";default:return"pi pi-clock"}}function z(e){switch(e){case"manual":return"info";case"schedule":return"success";case"api":return"warning";default:return"secondary"}}function E(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function D(e){return e<1e3?`${e}ms`:e<6e4?`${Math.round(e/1e3)}s`:e<36e5?`${Math.round(e/6e4)}m`:`${Math.round(e/36e5)}h`}function L(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString()}function G(e){if(!e)return"-";const s=Date.now()-new Date(e).getTime();return D(s)}return(e,s)=>{const r=Y("tooltip");return a(),u("div",ae,[n("div",le,[s[4]||(s[4]=n("h1",null,"Jobs",-1)),n("div",re,[n("span",ue,[s[3]||(s[3]=n("i",{class:"pi pi-search"},null,-1)),i(o(ee),{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=t=>b.value=t),placeholder:"Search jobs..."},null,8,["modelValue"])]),i(o(te),{modelValue:h.value,"onUpdate:modelValue":s[1]||(s[1]=t=>h.value=t),options:M,optionLabel:"label",optionValue:"value",placeholder:"Status"},null,8,["modelValue"]),i(o(se),{modelValue:V.value,"onUpdate:modelValue":s[2]||(s[2]=t=>V.value=t),selectionMode:"range",placeholder:"Date range",showIcon:!0},null,8,["modelValue"]),i(o(g),{label:"Refresh",icon:"pi pi-refresh",class:"p-button-outlined",onClick:f,loading:y.value},null,8,["loading"])])]),n("div",de,[n("div",ce,[n("span",pe,l(B.value),1),s[5]||(s[5]=n("span",{class:"stat-label"},"Running",-1))]),n("div",fe,[n("span",ve,l(I.value),1),s[6]||(s[6]=n("span",{class:"stat-label"},"Completed Today",-1))]),n("div",me,[n("span",ge,l(P.value),1),s[7]||(s[7]=n("span",{class:"stat-label"},"Failed Today",-1))]),n("div",ye,[n("span",be,l(F.value),1),s[8]||(s[8]=n("span",{class:"stat-label"},"Avg Duration",-1))])]),i(o(Z),{value:R.value,loading:y.value,paginator:!0,rows:15,rowsPerPageOptions:[15,30,50],dataKey:"id",responsiveLayout:"scroll",class:"p-datatable-sm",onRowClick:J},{empty:d(()=>[...s[9]||(s[9]=[n("div",{class:"empty-state"},[n("i",{class:"pi pi-clock",style:{"font-size":"3rem",color:"var(--text-color-secondary)"}}),n("p",null,"No jobs found")],-1)])]),default:d(()=>[i(o(c),{field:"id",header:"Job ID",style:{width:"150px"}},{body:d(({data:t})=>[n("code",he,l(t.id.substring(0,8)),1)]),_:1}),i(o(c),{field:"pipelineName",header:"Pipeline",style:{"min-width":"200px"}},{body:d(({data:t})=>[n("div",_e,[n("span",we,l(t.pipelineName),1),n("span",ke,"v"+l(t.pipelineVersion),1)])]),_:1}),i(o(c),{field:"status",header:"Status",style:{width:"130px"}},{body:d(({data:t})=>[i(o(T),{value:t.status,severity:K(t.status),icon:O(t.status)},null,8,["value","severity","icon"])]),_:1}),i(o(c),{field:"progress",header:"Progress",style:{width:"150px"}},{body:d(({data:t})=>[t.status==="running"?(a(),$(o(ne),{key:0,value:t.progress,showValue:!0,style:{height:"8px"}},null,8,["value"])):t.status==="completed"?(a(),u("span",xe,"100%")):t.status==="failed"?(a(),u("span",De,"Failed")):(a(),u("span",Ce,"-"))]),_:1}),i(o(c),{field:"metrics",header:"Metrics",style:{width:"180px"}},{body:d(({data:t})=>[t.metrics?(a(),u("div",$e,[n("span",null,[s[10]||(s[10]=n("i",{class:"pi pi-database"},null,-1)),A(" "+l(L(t.metrics.rowsProcessed))+" rows",1)]),n("span",null,[s[11]||(s[11]=n("i",{class:"pi pi-share-alt"},null,-1)),A(" "+l(L(t.metrics.quadsGenerated))+" quads",1)])])):(a(),u("span",Se,"-"))]),_:1}),i(o(c),{field:"startedAt",header:"Started",sortable:!0,style:{width:"150px"}},{body:d(({data:t})=>[t.startedAt?(a(),u("span",Ve,l(E(t.startedAt)),1)):(a(),u("span",Je,"Pending"))]),_:1}),i(o(c),{field:"duration",header:"Duration",style:{width:"100px"}},{body:d(({data:t})=>[t.duration?(a(),u("span",Le,l(D(t.duration)),1)):t.status==="running"?(a(),u("span",Ae,l(G(t.startedAt)),1)):(a(),u("span",Ne,"-"))]),_:1}),i(o(c),{field:"triggeredBy",header:"Trigger",style:{width:"100px"}},{body:d(({data:t})=>[i(o(T),{value:t.triggeredBy,severity:z(t.triggeredBy)},null,8,["value","severity"])]),_:1}),i(o(c),{style:{width:"120px"}},{body:d(({data:t})=>[n("div",Te,[t.status==="running"?_((a(),$(o(g),{key:0,icon:"pi pi-stop",class:"p-button-rounded p-button-danger p-button-text",onClick:w(C=>U(t),["stop"])},null,8,["onClick"])),[[r,"Cancel"]]):N("",!0),t.status==="failed"?_((a(),$(o(g),{key:1,icon:"pi pi-refresh",class:"p-button-rounded p-button-warning p-button-text",onClick:w(C=>j(t),["stop"])},null,8,["onClick"])),[[r,"Retry"]]):N("",!0),_(i(o(g),{icon:"pi pi-file",class:"p-button-rounded p-button-secondary p-button-text",onClick:w(C=>q(t),["stop"])},null,8,["onClick"]),[[r,"Logs"]]),_(i(o(g),{icon:"pi pi-external-link",class:"p-button-rounded p-button-text",onClick:w(C=>J({data:t}),["stop"])},null,8,["onClick"]),[[r,"Details"]])])]),_:1})]),_:1},8,["value","loading"])])}}}),Qe=ie(Me,[["__scopeId","data-v-073d96c1"]]);export{Qe as default};
