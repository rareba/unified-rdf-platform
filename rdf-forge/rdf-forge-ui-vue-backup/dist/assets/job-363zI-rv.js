import{g as I,r as f,h as v}from"./index-DFPn2aEF.js";import{g as i,p as h,d as b}from"./client-D1Swh3D-.js";async function k(t){return i("/jobs",t)}async function q(t){return i(`/jobs/${t}`)}async function z(t,c,r){return h("/jobs",{pipelineId:t,variables:c,priority:r})}async function A(t){return b(`/jobs/${t}`)}async function B(t){return h(`/jobs/${t}/retry`)}async function D(t,c){return i(`/jobs/${t}/logs`,c)}async function E(){return i("/schedules")}async function F(t,c,r){return h("/schedules",{pipelineId:t,cronExpression:c,variables:r})}async function G(t){return b(`/schedules/${t}`)}const M=I("job",()=>{const t=f([]),c=f(null),r=f([]),o=f([]),l=f(!1),a=f(null),y=v(()=>t.value.filter(e=>e.status==="running")),d=v(()=>t.value.filter(e=>e.status==="pending"));async function J(e){l.value=!0,a.value=null;try{return t.value=await k(e),t.value}catch(n){return a.value=n.message,[]}finally{l.value=!1}}async function g(e){l.value=!0,a.value=null;try{return c.value=await q(e),c.value}catch(n){return a.value=n.message,null}finally{l.value=!1}}async function m(e,n,s){l.value=!0,a.value=null;try{const u=await z(e,n,s);return t.value.unshift(u),u}catch(u){throw a.value=u.message,u}finally{l.value=!1}}async function w(e){var n;try{await A(e);const s=t.value.findIndex(u=>u.id===e);s>=0&&(t.value[s].status="cancelled"),((n=c.value)==null?void 0:n.id)===e&&(c.value.status="cancelled")}catch(s){throw a.value=s.message,s}}async function $(e){try{const n=await B(e);return t.value.unshift(n),n}catch(n){throw a.value=n.message,n}}async function p(e,n){try{return r.value=await D(e,n),r.value}catch(s){return a.value=s.message,[]}}function S(e){r.value.push(e)}async function j(){try{return o.value=await E(),o.value}catch(e){return a.value=e.message,[]}}async function L(e,n,s){try{const u=await F(e,n,s);return o.value.push(u),u}catch(u){throw a.value=u.message,u}}async function x(e){try{await G(e),o.value=o.value.filter(n=>n.id!==e)}catch(n){throw a.value=n.message,n}}function C(){c.value=null,r.value=[]}return{jobs:t,currentJob:c,currentJobLogs:r,schedules:o,loading:l,error:a,runningJobs:y,pendingJobs:d,fetchJobs:J,fetchJob:g,createJob:m,cancelJob:w,retryJob:$,fetchJobLogs:p,appendLog:S,fetchSchedules:j,createSchedule:L,deleteSchedule:x,clearCurrentJob:C}});export{M as u};
